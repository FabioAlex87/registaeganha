<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Regista & Ganha – Categoria</title>
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div class="wrap">
        <header>
            <div class="brand-area">
                <a href="index.html" class="logo">
                    <img src="logo.png" alt="R&G Logo">
                </a>
                <div class="title">
                    <h1>Regista & Ganha</h1>
                    <p>Categoria: <span id="category-title">Carregando...</span></p>
                </div>
            </div>
        </header>

        <nav class="main-nav">
            <div class="nav-item">
                <a href="index.html" class="nav-link">Início</a>
            </div>
            <div class="nav-item active" id="categories-menu">
                <a href="#" class="nav-link">Categorias ▼</a>
                <div class="dropdown" id="dropdown-categorias">
                    <a href="category.html?id=todos">Todos os Cupões</a>
                    <a href="category.html?id=amazon-renewed">Amazon Renewed</a>
                    <a href="category.html?id=aparelhos-acessorios">Aparelhos e Acessórios Amazon</a>
                    <a href="category.html?id=aplicacoes-jogos">Aplicações e Jogos</a>
                    <a href="category.html?id=automovel">Automóvel</a>
                    <a href="category.html?id=bagagem">Bagagem</a>
                    <a href="category.html?id=beleza">Beleza</a>
                    <a href="category.html?id=bricolage-ferramentas">Bricolage e Ferramentas</a>
                    <a href="category.html?id=brinquedos-jogos">Brinquedos e Jogos</a>
                    <a href="category.html?id=cartoes-oferta">Cartões Oferta</a>
                    <a href="category.html?id=casa-cozinha">Casa e Cozinha</a>
                    <a href="category.html?id=computadores">Computadores</a>
                    <a href="category.html?id=eletrodomesticos">Eletrodomésticos</a>
                    <a href="category.html?id=eletronica">Eletrónica</a>
                    <a href="category.html?id=jogos-video">Jogos de Vídeo</a>
                    <a href="category.html?id=livros">Livros</a>
                    <a href="category.html?id=moda">Moda</a>
                    <a href="category.html?id=saude-casa">Saúde e Casa</a>
                </div>
            </div>
            <div class="nav-item">
                <a href="sobre-nos.html" class="nav-link">Sobre nós</a>
            </div>
            <div class="nav-item">
                <a href="contacto.html" class="nav-link">Contacto</a>
            </div>
        </nav>

        <main>
            <section class="grid" id="grid">
                <!-- Products will be injected here via JS -->
            </section>
            <div id="no-products" class="fallback" style="display: none;">
                <p>Não foram encontrados produtos nesta categoria.</p>
                <a href="index.html" class="btn primary" style="margin-top: 20px;">Voltar ao Início</a>
            </div>
        </main>

        <footer>
            <p>© <span id="year"></span> Regista & Ganha. Todos os direitos reservados.</p>
            <p><a href="privacidade.html">Privacidade</a> · <a href="cookies.html">Cookies</a></p>
        </footer>
    </div>

    <script>
        // Utils
        document.getElementById('year').textContent = new Date().getFullYear();
        const catMenu = document.getElementById('categories-menu');
        catMenu.addEventListener('click', () => catMenu.classList.toggle('open'));
        document.addEventListener('click', (e) => {
            if (!catMenu.contains(e.target)) catMenu.classList.remove('open');
        });

        // Mock Data (In a real app, fetch from Contentful or JSON)
        const mockProducts = [
            {
                cat: 'eletrodomesticos',
                title: 'Aspirador Robô Inteligente XYZ',
                desc: 'Limpeza totalmente automatizada para a sua casa.',
                price: '99,99€',
                oldPrice: '199,99€',
                off: '-50% OFF',
                img: 'https://via.placeholder.com/300x180?text=IMAGEM+ASPIRADOR',
                link: '#',
                coupon: 'CUPAO50OFF'
            },
            {
                cat: 'eletronica',
                title: 'Auriculares Sem Fios Premium',
                desc: 'Qualidade de som superior e bateria de longa duração.',
                price: '29,90€',
                oldPrice: '49,90€',
                off: '-40% OFF',
                img: 'https://via.placeholder.com/300x180?text=IMAGEM+AURIICULARES',
                link: '#',
                coupon: '40AURI'
            },
            {
                cat: 'casa-cozinha',
                title: 'Fritadeira Sem Óleo 5L',
                desc: 'Cozinha saudável para toda a família.',
                price: '75,00€',
                oldPrice: '120,00€',
                off: '-35% OFF',
                img: 'https://via.placeholder.com/300x180?text=IMAGEM+FRITADEIRA',
                link: '#',
                coupon: 'FRITA35'
            },
            {
                cat: 'computadores',
                title: 'Monitor Gaming 27"',
                desc: '144Hz, 1ms resposta, IPS.',
                price: '199,00€',
                oldPrice: '250,00€',
                off: '-20% OFF',
                img: 'https://via.placeholder.com/300x180?text=IMAGEM+MONITOR',
                link: '#',
                coupon: 'GAME20'
            }
        ];

        // Logic
        const urlParams = new URLSearchParams(window.location.search);
        const categoryId = urlParams.get('id');
        const titleSpan = document.getElementById('category-title');
        const grid = document.getElementById('grid');
        const noProducts = document.getElementById('no-products');

        function renderProducts() {
            // 1. Filter
            let filtered = [];
            if (!categoryId || categoryId === 'todos') {
                filtered = mockProducts;
                titleSpan.textContent = "Todos os Cupões";
            } else {
                filtered = mockProducts.filter(p => p.cat === categoryId);
                // Format title
                const formattedTitle = categoryId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                titleSpan.textContent = formattedTitle;
            }

            // 2. Render
            if (filtered.length === 0) {
                grid.style.display = 'none';
                noProducts.style.display = 'block';
                return;
            }

            grid.innerHTML = filtered.map(p => `
        <article class="card">
          <span class="badge">${p.cat}</span>
          <img class="product-image" src="${p.img}" alt="${p.title}">
          <div>
            <h3>${p.title}</h3>
            <p class="tagline">${p.desc}</p>
          </div>
          <div class="price-tag">
            <div class="price-info">
              <span class="discount-price">${p.price}</span>
              <span class="original-price">${p.oldPrice}</span>
            </div>
            <span class="discount-badge">${p.off}</span>
          </div>

          <div class="cta">
            <a class="btn primary" href="${p.link}" target="_blank" rel="nofollow">
              Ver Oferta Amazon
            </a>
            <button class="btn secondary btn-copy" data-copy="${p.coupon}" aria-label="Copiar cupão" onclick="copyCode(this, '${p.coupon}')">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
        </article>
      `).join('');
        }

        // Copy function
        async function copyCode(btn, code) {
            try {
                await navigator.clipboard.writeText(code);
                const originalIcon = btn.innerHTML;
                btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4ade80" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                setTimeout(() => {
                    btn.innerHTML = originalIcon;
                }, 2000);
            } catch (err) {
                console.error('Failed to copy', err);
            }
        }

        renderProducts();

    </script>
</body>

</html>